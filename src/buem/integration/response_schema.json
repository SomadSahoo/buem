{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "EnerPlanET Response Schema",
  "type": "object",
  "required": ["type", "features"],
  "properties": {
    "type": { "const": "FeatureCollection" },
    "timeStamp": { "type": "string" },
    "numberMatched": { "type": "number" },
    "numberReturned": { "type": "number" },

    "features": {
      "type": "array",
      "items": { "$ref": "#/$defs/feature" }
    }
  },

  "$defs": {
    "feature": {
      "type": "object",
      "required": ["type", "id", "geometry", "properties"],
      "properties": {
        "type": { "const": "Feature" },
        "id": { "type": "string" },

        "geometry": {
          "type": "object",
          "required": ["type", "coordinates"],
          "properties": {
            "type": { "const": "Point" },
            "coordinates": {
              "type": "array",
              "items": { "type": "number" },
              "minItems": 2,
              "maxItems": 2
            }
          }
        },

        "properties": {
          "type": "object",
          "required": [
            "start_time",
            "end_time",
            "resolution",
            "resolution_unit",
            "buem"
          ],
          "properties": {
            "start_time": { "type": "string", "format": "date-time" },
            "end_time": { "type": "string", "format": "date-time" },
            "resolution": { "type": "string" },
            "resolution_unit": { "type": "string" },

            "buem": {
              "type": "object",
              "required": [
                "building_attributes",
                "child_components",
                "thermal_load_profile"
              ],

              "properties": {
                "building_attributes": {
                  "type": "object",
                  "description": "Attributes provided in the request and returned unchanged."
                },

                "child_components": {
                  "type": "array",
                  "items": { "$ref": "#/$defs/child_component" }
                },

                "thermal_load_profile": {
                  "type": "object",
                  "required": [
                    "start_time",
                    "end_time",
                    "heat",
                    "cool",
                    "electricity"
                  ],
                  "properties": {
                    "start_time": { "type": "string", "format": "date-time" },
                    "end_time": { "type": "string", "format": "date-time" },
                    "heat": {
                      "type": "array",
                      "items": { "type": "number" }
                    },
                    "cool": {
                      "type": "array",
                      "items": { "type": "number" }
                    },
                    "electricity": {
                      "type": "array",
                      "items": { "type": "number" }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },

    "child_component": {
      "type": "object",
      "required": [
        "component_id",
        "component_type",
        "area_m2",
        "orientation_deg",
        "tilt_deg"
      ],
      "properties": {
        "component_id": { "type": "string" },
        "component_type": { "type": "string" },
        "area_m2": { "type": "number" },
        "orientation_deg": { "type": "number" },
        "tilt_deg": { "type": "number" }
      }
    }
  }
}
